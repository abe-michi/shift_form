
# シフトアプリ開発 要件定義書（v1.0）

## 1. 基本コンセプト
| 項目 | 決定内容 |
|------|----------|
| 対象 | 従業員提出・管理者管理のシフト＋人件費管理ツール |
| フロント | **PC**: タブ切替 UI<br>**スマホ**: サイドバー＋カード |
| バックエンド | Google Apps Script ＋ Google スプレッドシート |
| 販売形態 | 買い切りライセンス（オンラインキー認証） |

## 2. シフト提出・管理
| トピック | 決定内容 |
|----------|----------|
| 期間単位 | 月 / 半月 / 週 からマスタで 1 つ選択 |
| 締切設定 | 期間ごとに日付または曜日をマスタ設定（編集可） |
| 編集権限 | 従業員: 期限内は無制限で編集可<br>管理者: 常時編集可 |
| バリデーション | **送信時**: 開始 < 終了・重複シフトは上書き確認<br>**管理者編集**: インターバル（マスタ設定）・法定時間（マスタ設定） |
| バッチ更新 | 手動更新ボタン ＋ ユーザー設定の定時バッチ（回数・時刻を複数設定可） |

## 3. ガント & テーブル（PC）
| 項目 | ガント | テーブル |
|------|--------|----------|
| 表示 | タブ切替（表🗒 / ガント📊） | 氏名列＋日付ヘッダ行を固定 |
| 時間刻み | 15 / 30 / 60 分をマスタ選択 | — |
| 編集 | ドラッグ＋時刻ピッカー＋±ボタン | セル入力 |
| スナップ | 選択した刻みに吸着 | — |
| バー色 | 凡例マスタで固定色、未設定時は **#A5D6A7** | — |
| ツールチップ | 氏名・勤務帯・実働時間を表示 | — |

## 4. スマホ UI
- ホーム画面: **今日＋1週間**のカード表示  
- シフトが無い日はカードは表示、シフト行は空、Google予定のみ  
- Google予定: 最大2件表示、3件目は半分見切れ＋コラプス展開  
- 編集: カードをタップ → 時刻ピッカーまたは±ボタン

## 5. 人件費・ダッシュボード
| 役割 | 指標 | チャート | 期間選択 | エクスポート | 自動配信 |
|------|------|----------|----------|--------------|-----------|
| **管理者** | 2,3,4,5,6,7,8(クラスター推移) | Mixed (折れ線＋棒) | 週 / 半月 / 月 / 四半期 / 半期 / 年 | PDF / CSV / Spreadsheet / Excel / PowerPoint（選択式、デフォ: Spreadsheet） | 週 / 半月 / 月（複数選択可、デフォ OFF、送信 12:00） |
| **従業員** | 1,2,3,4,5,6 | Mixed | 同上 | 同上 | 配信なし |

## 6. 給与計算
| 項目 | 内容 |
|------|------|
| サイクル | `monthly` / `weekly` / `daily` を従業員マスタで管理 |
| 休憩控除 | 労基法準拠 (6h→45m, 8h→1h) ※マスタで変更可 |
| 割増 & みなし | 全パターン＋みなし残業をマスタ管理（倍率編集可） |
| 税・社保 | 現状対象外（拡張候補） |

## 7. クラスター管理
- **所属クラスター**: 部署 / 店舗 / チーム（所属マスタ）
- **役職クラスター**: 職名マスタ
- **職種クラスター**: 職種マスタ
- **ベテラン区分**: 在籍年数・総労働時間で自動分類
- **ユーザー定義クラスター**: 任意追加可

## 8. バックアップ & ログ
| 項目 | 内容 |
|------|------|
| バックアップ | 自動: **毎日**（保存先・保持期間をユーザー設定、初期: Drive 90日）＋手動ダウンロード |
| ログ保存 | 30 / 90 / ∞ / 自由入力から選択 |
| 障害対応 | メール通知＋自動リトライ **最大3回** |

## 9. 非機能要件
| 項目 | 基準 |
|------|------|
| 表示速度 | 2 秒以内 |
| 集計速度 | 30 秒以内 |
| アクセシビリティ | キーボード操作＋スクリーンリーダ |
| 色覚対応 | チェック / 自動補正をユーザー切替 |
| セキュリティ | HTTPS + GAS 権限管理 |
| バージョン規約 | セマンティック (MAJOR.MINOR.PATCH) |
| UAT | 機能・性能・セキュリティ・A11y・i18n フルテスト |
| 多言語 | 日本語 / 英語 |
| タイムゾーン | 初期: 日本時間固定（拡張候補で multi-TZ） |

## 10. ドキュメント & サポート
| 項目 | 内容 |
|------|------|
| マニュアル | PDF ガイド ＋ Web ヘルプ |
| サポート窓口 | メールアドレス ＋ FAQ サイト |
| アップデート | 自動アップデート |
| 拡張候補 | 税・社保計算, 給与ソフトCSV, multi-TZ, Webhook通知 など |

## 11. リリース & バージョニング
- バージョン形式: **セマンティック** (MAJOR.MINOR.PATCH)
- 例: 1.0.0 (初版) → 1.0.1 (バグ修正) → 1.1.0 (軽微機能追加) → 2.0.0 (互換性を壊す変更)

---
